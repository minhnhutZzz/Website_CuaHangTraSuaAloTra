<div th:replace="~{layouts/main-layout :: layout('Đặt hàng thành công - TRÀ SỮA MONA', ~{::content})}">
  <div th:fragment="content">
    <main class="container mx-auto px-4 py-8">
      <div class="max-w-2xl mx-auto">
        <!-- Success Header -->
        <div class="text-center mb-8">
          <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
            <i class="fas fa-check text-4xl text-green-600"></i>
          </div>
          <h1 class="text-3xl font-bold text-green-600 mb-2" 
              th:text="${paymentMethod == 'COD' ? 'Đặt hàng thành công!' : 'Thanh toán thành công!'}">
            Đặt hàng thành công!
          </h1>
          <p class="text-gray-600">Đơn hàng của bạn đã được xác nhận và sẽ được xử lý sớm nhất.</p>
        </div>

        <!-- Order Details -->
        <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 mb-6">
          <h2 class="text-xl font-semibold text-[#2f604a] mb-4">Thông tin đơn hàng</h2>
          
          <div class="space-y-3">
            <div class="flex justify-between">
              <span class="text-gray-600">Mã đơn hàng:</span>
              <span class="font-semibold" th:text="${orderId}">#123456</span>
            </div>
            
            <div class="flex justify-between">
              <span class="text-gray-600">Số tiền:</span>
              <span class="font-semibold text-[#cb5439]" th:text="${totalPrice != null ? totalPrice + '₫' : '0₫'}">300.000₫</span>
            </div>
            
            <div class="flex justify-between">
              <span class="text-gray-600" 
                    th:text="${paymentMethod == 'COD' ? 'Thời gian đặt hàng:' : 'Thời gian thanh toán:'}">
                Thời gian đặt hàng:
              </span>
              <span class="font-semibold" th:text="${paymentTime}">2025-01-22 14:30:25</span>
            </div>
            
            <div class="flex justify-between" th:if="${paymentMethod != 'COD'}">
              <span class="text-gray-600">Mã giao dịch:</span>
              <span class="font-semibold font-mono" th:text="${transactionId}">1423456789</span>
            </div>
            
            <div class="flex justify-between" th:if="${paymentMethod != 'COD'}">
              <span class="text-gray-600">Ngân hàng:</span>
              <span class="font-semibold" th:text="${bankCode}">NCB</span>
            </div>
            
            <div class="flex justify-between" th:if="${paymentMethod != 'COD'}">
              <span class="text-gray-600">Loại thẻ:</span>
              <span class="font-semibold" th:text="${cardType}">ATM</span>
            </div>
            
            <div class="flex justify-between" th:if="${paymentMethod == 'COD'}">
              <span class="text-gray-600">Phương thức thanh toán:</span>
              <span class="font-semibold text-[#cb5439]">COD - Thu tiền khi nhận hàng</span>
            </div>
          </div>
        </div>

        <!-- Payment/Order Status -->
        <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
          <div class="flex items-center">
            <i class="fas fa-shield-check text-green-600 mr-3"></i>
            <div>
              <h3 class="font-semibold text-green-800" 
                  th:text="${paymentMethod == 'COD' ? 'Trạng thái đơn hàng' : 'Trạng thái thanh toán'}">
                Trạng thái đơn hàng
              </h3>
              <p class="text-green-700" th:text="${statusText}">Đặt hàng thành công</p>
            </div>
          </div>
        </div>

        <!-- Next Steps -->
        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
          <h3 class="font-semibold text-blue-800 mb-2">Bước tiếp theo</h3>
          <ul class="text-blue-700 space-y-1" th:if="${paymentMethod == 'COD'}">
            <li>• Shipper sẽ liên hệ với bạn để xác nhận đơn hàng</li>
            <li>• Đơn hàng sẽ được chuẩn bị và giao trong thời gian sớm nhất</li>
            <li>• Thanh toán khi nhận hàng (COD)</li>
            <li>• Vui lòng giữ điện thoại để nhận cuộc gọi từ shipper</li>
          </ul>
          <ul class="text-blue-700 space-y-1" th:if="${paymentMethod != 'COD'}">
            <li>• Chúng tôi sẽ gửi email xác nhận đơn hàng</li>
            <li>• Đơn hàng sẽ được chuẩn bị trong 1-2 ngày làm việc</li>
            <li>• Bạn sẽ nhận được thông báo khi đơn hàng được giao</li>
          </ul>
        </div>

        <!-- Action Buttons -->
        <div class="flex flex-col sm:flex-row gap-4">
          <a href="/" class="flex-1 bg-[#2f604a] text-white py-3 px-6 rounded-lg text-center font-semibold hover:bg-[#1e3d2e] transition-colors">
            <i class="fas fa-home mr-2"></i>
            Về trang chủ
          </a>
          <a href="/products" class="flex-1 bg-gray-100 text-gray-700 py-3 px-6 rounded-lg text-center font-semibold hover:bg-gray-200 transition-colors">
            <i class="fas fa-shopping-bag mr-2"></i>
            Tiếp tục mua sắm
          </a>
        </div>
      </div>
    </main>
  </div>
</div>

<script>
// Clear cart after successful payment
document.addEventListener('DOMContentLoaded', function() {
    // Clear cart from localStorage
    localStorage.removeItem('cart');
    
    // Update cart count in header
    const cartSpan = document.querySelector('.fa-shopping-cart').nextElementSibling;
    if (cartSpan) {
        cartSpan.textContent = '0';
    }
    
    console.log('Cart cleared after successful payment');
});
</script>
